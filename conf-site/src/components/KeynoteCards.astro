---
interface Keynote {
    title: string;
    time?: string;
    date?: string;
    speaker: string;
    affiliation?: string;
    abstract?: string;
    biography?: string;
    image?: string;
}

interface Props {
    items: Keynote[];
    title?: string;
}

const { items, title = "Keynote Speakers" } = Astro.props;

const base = import.meta.env.BASE_URL;
const getAssetUrl = (path: string) => {
    if (!path) return "";
    if (path.startsWith("http")) return path;
    const normalizedBase = base.endsWith("/") ? base : base + "/";
    const cleanPath = path.startsWith("/") ? path.slice(1) : path;
    return `${normalizedBase}${cleanPath}`;
};
---

<div class="space-y-8">
    <h2
        class="text-3xl font-bold text-gray-900 mb-6 border-b-2 border-blue-900 pb-2 inline-block"
    >
        {title}
    </h2>

    <div class="grid grid-cols-1 gap-6">
        {
            items.map((item) => (
                <article class="bg-white p-6 md:p-8 rounded-2xl shadow-xl border border-gray-100">
                    <div class="flex flex-col md:flex-row gap-6 md:gap-8">
                        <div class="w-full md:w-40 flex-shrink-0">
                            <div class="w-32 h-32 md:w-40 md:h-40 bg-gray-100 rounded-xl overflow-hidden ring-4 ring-blue-50 shadow-sm">
                                {item.image ? (
                                    <img
                                        src={getAssetUrl(item.image)}
                                        alt={item.speaker}
                                        class="w-full h-full object-cover"
                                        loading="lazy"
                                    />
                                ) : (
                                    <div class="w-full h-full flex items-center justify-center text-gray-400">
                                        <svg
                                            class="w-12 h-12"
                                            fill="currentColor"
                                            viewBox="0 0 20 20"
                                        >
                                            <path
                                                fill-rule="evenodd"
                                                d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
                                                clip-rule="evenodd"
                                            />
                                        </svg>
                                    </div>
                                )}
                            </div>
                        </div>

                        <div class="flex-1">
                            <div class="text-sm text-blue-700 font-bold uppercase tracking-widest">
                                {item.time && item.date
                                    ? `${item.time} Â· ${item.date}`
                                    : item.time || item.date}
                            </div>
                            <h3 class="text-2xl font-extrabold text-[#1a3050] mt-2">
                                {item.title}
                            </h3>
                            <p class="text-lg font-semibold text-gray-900 mt-3">
                                {item.speaker}
                            </p>
                            {item.affiliation && (
                                <p class="text-sm text-gray-500 mt-1">
                                    {item.affiliation}
                                </p>
                            )}

                            {item.abstract && (
                                <div class="mt-5">
                                    <h4 class="text-sm font-bold uppercase tracking-widest text-gray-500">
                                        Abstract
                                    </h4>
                                    <p class="text-gray-700 leading-relaxed mt-2">
                                        {item.abstract}
                                    </p>
                                </div>
                            )}

                            {item.biography && (
                                <div class="mt-5">
                                    <h4 class="text-sm font-bold uppercase tracking-widest text-gray-500">
                                        Biography
                                    </h4>
                                    <p class="text-gray-700 leading-relaxed mt-2">
                                        {item.biography}
                                    </p>
                                </div>
                            )}
                        </div>
                    </div>
                </article>
            ))
        }
    </div>
</div>
